# API бэкенда (контракт)

При заданной переменной окружения `VITE_API_URL` приложение переходит в **серверный режим**: авторизация, статистика, опыт и прогресс по словам запрашиваются и сохраняются на сервере. Это нужно для многоплатформенности (один прогресс на всех устройствах).

## Авторизация

Заголовок для защищённых запросов: `Authorization: Bearer <token>`.

| Метод | Путь | Описание |
|-------|------|----------|
| POST | `/auth/register` | Регистрация. Body: `{ "username": string, "password": string }`. Ответ: `{ "token": string, "user": User }`. |
| POST | `/auth/login` | Вход. Body: `{ "username", "password }`. Ответ: `{ "token", "user" }`. |
| GET | `/auth/check-username?username=...` | Проверка доступности логина. Ответ: `{ "available": boolean }`. |

## Профиль и прогресс

| Метод | Путь | Описание |
|-------|------|----------|
| GET | `/me` | Текущий пользователь (с полями `stats`, `wordProgress`). Ответ: объект `User`. |
| PATCH | `/me` | Частичное обновление. Body: `{ "username"?: string, "stats"?: Partial<UserStats>, "wordProgress"?: WordProgressMap }`. Ответ: обновлённый `User`. |

Типы `User`, `UserStats`, `WordProgressMap` описаны в `src/data/contracts/types.ts`.

## Поведение клиента

- После успешного логина/регистрации клиент сохраняет `token` в `localStorage` и кэширует `user` в памяти.
- При загрузке приложения, если есть `token`, вызывается `GET /me` и кэш заполняется.
- Все изменения (статистика после игр, прогресс по словам, смена никнейма) отправляются через `PATCH /me`; ответ обновляет кэш.
